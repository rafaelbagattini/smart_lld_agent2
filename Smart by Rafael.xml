<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2023-03-30T18:11:37Z</date>
    <groups>
        <group>
            <uuid>119e0830b2984cc8ac3aa43aad9629c8</uuid>
            <name>Casa</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>d1616f8778d546b087b0b5b610a768b7</uuid>
            <template>SMART COM DISCOVERY by Rafael</template>
            <name>SMART COM DISCOVERY by Rafael</name>
            <description>Utiliza o Smartmonitortools para verificar o SMART do seu nvme.</description>
            <groups>
                <group>
                    <name>Casa</name>
                </group>
            </groups>
            <discovery_rules>
                <discovery_rule>
                    <uuid>9bffaa98d6864da29f0d27ebe1b3c8a4</uuid>
                    <name>Listar discos</name>
                    <key>smartctl.listar</key>
                    <filter>
                        <evaltype>OR</evaltype>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>6c062ed51359446b8f4ce9e86ef6ab60</uuid>
                            <name>[{#NAME}] - Calibration_Retry_Count</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.callibration.retry.count.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.ata_smart_attributes.table.[?(@.name == 'Calibration_Retry_Count')].flags.value</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>13b0b5ae64d34caeb32ea7972fa7326a</uuid>
                            <name>[{#NAME}] - Desligamentos errados</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.desligamentos.errados.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.nvme_smart_health_information_log.unsafe_shutdowns</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>58db4abd21734799bf7e6562c8466104</uuid>
                            <name>[{#NAME}] - Erros Críticos</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.erros.criticos.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.nvme_smart_health_information_log.critical_warning</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1f666a85f3e54bf09794ee66a179dba4</uuid>
                            <name>[{#NAME}] - Horas Ligado</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.horas.ligado.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.power_on_time.hours</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a156fd8c98524688954d2133e05cd72f</uuid>
                            <name>Dados de [{#NAME}]</name>
                            <key>smartctl.ler[{#NAME}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                        </item_prototype>
                        <item_prototype>
                            <uuid>17eacf8156914ec5a1f5e9a78a27a869</uuid>
                            <name>[{#NAME}] - Nome</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.nome.[{#NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.model_name</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1b132d8d29eb4665b3620dc5d7d74bc2</uuid>
                            <name>[{#NAME}] - Número de série</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.numero.serie.[{#NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.serial_number</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>10097bbaf56947238fc685652cff3ef2</uuid>
                            <name>[{#NAME}] - Raw_Read_Error_Rate</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.raw.read.error.rate.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.ata_smart_attributes.table.[?(@.name == 'Raw_Read_Error_Rate')].flags.value</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b286cd0723314fb9a3171983bc116397</uuid>
                            <name>[{#NAME}] - Reallocated_Sector_Ct</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.reallocated.sector.ct.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.ata_smart_attributes.table.[?(@.name == 'Reallocated_Sector_Ct')].flags.value</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>60039dc124e24ea88d4b775e393350a8</uuid>
                            <name>[{#NAME}] - Saúde (em %)</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.saude.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.nvme_smart_health_information_log.available_spare</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>312382df51844d19adb52471160aa15b</uuid>
                            <name>[{#NAME}] - Seek_Error_Rate</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.seek.error.rate.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.ata_smart_attributes.table.[?(@.name == 'Seek_Error_Rate')].flags.value</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ec9f290e86a34dd293fc5b26747a1d98</uuid>
                            <name>[{#NAME}] - Spin_Retry_Count</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.spin.retry.count.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.ata_smart_attributes.table.[?(@.name == 'Spin_Retry_Count')].flags.value</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8eab3ce2c2084a5fb2837ce5c487daa1</uuid>
                            <name>[{#NAME}] - Spin_Up_Time</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.spin.up.time.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.ata_smart_attributes.table.[?(@.name == 'Spin_Up_Time')].flags.value</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>072e03b0d2cc4e2b9bff475ae56a5144</uuid>
                            <name>[{#NAME}] - Start_Stop_Count</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.start.stop.count.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.ata_smart_attributes.table.[?(@.name == 'Start_Stop_Count')].flags.value</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>f564d46598094190973124675a54e7d3</uuid>
                            <name>[{#NAME}] - Status</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.status.[{#NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <valuemap>
                                <name>Status</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.smart_status.passed</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>f7154bbdb2a441b08a952ae78e0f7a75</uuid>
                            <name>[{#NAME}] - TBW</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.tbw.[{#NAME}]</key>
                            <delay>0</delay>
                            <units>b</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.nvme_smart_health_information_log.data_units_written</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>512000</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0d3b8fd13dbe404d83986898f395a2c1</uuid>
                            <name>[{#NAME}] - Temperatura</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.temperatura.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.temperature.current</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>758c6248d88349b087991b892b3cf708</uuid>
                            <name>[{#NAME}] - Velocidade SATA</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.velocidade.sata.[{#NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.interface_speed.max.string</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>65e9531bd1624b5cbba43571d7471de1</uuid>
                            <name>[{#NAME}] - Versão Firmware</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.versao.firmware.[{#NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.firmware_version</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9fdd2178508949b9b796809ba18b19aa</uuid>
                            <name>[{#NAME}] - Vezes ligado</name>
                            <type>DEPENDENT</type>
                            <key>smartctl.vezes.ligado.[{#NAME}]</key>
                            <delay>0</delay>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.power_cycle_count</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>smartctl.ler[{#NAME}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#TYPE}</lld_macro>
                            <path>$.type</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.devices</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <overrides>
                        <override>
                            <name>Remover itens dos HD's</name>
                            <step>1</step>
                            <filter>
                                <conditions>
                                    <condition>
                                        <macro>{#TYPE}</macro>
                                        <value>ata</value>
                                        <formulaid>A</formulaid>
                                    </condition>
                                </conditions>
                            </filter>
                            <operations>
                                <operation>
                                    <operationobject>ITEM_PROTOTYPE</operationobject>
                                    <operator>REGEXP</operator>
                                    <value>Desligamentos|Erros|Saúde|TBW</value>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                </operation>
                            </operations>
                        </override>
                        <override>
                            <name>Remover itens dos nvme's</name>
                            <step>2</step>
                            <filter>
                                <conditions>
                                    <condition>
                                        <macro>{#TYPE}</macro>
                                        <value>nvme</value>
                                        <formulaid>A</formulaid>
                                    </condition>
                                </conditions>
                            </filter>
                            <operations>
                                <operation>
                                    <operationobject>ITEM_PROTOTYPE</operationobject>
                                    <operator>REGEXP</operator>
                                    <value>SATA|Raw_Read_Error_Rate|Spin_Up_Time|Start_Stop_Count|Reallocated_Sector_Ct|Seek_Error_Rate|Spin_Retry_Count|Calibration_Retry_Count</value>
                                    <status>DISABLED</status>
                                    <discover>NO_DISCOVER</discover>
                                </operation>
                            </operations>
                        </override>
                    </overrides>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$DISK0}</macro>
                    <value>^.sda</value>
                </macro>
                <macro>
                    <macro>{$DISK1}</macro>
                    <value>^.sdb</value>
                </macro>
            </macros>
            <valuemaps>
                <valuemap>
                    <uuid>dae3204d26b34f1d9bcc8f03872e2625</uuid>
                    <name>Status</name>
                    <mappings>
                        <mapping>
                            <value>true</value>
                            <newvalue>OK</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
</zabbix_export>
